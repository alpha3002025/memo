## 01. MSA 기초 지식

## 애플리케이션의 변화 양상

Local Application

- 초창기에는 로컬에서 바이너리로 동작하는 .exe, .app 등과 같은 클라이언트 프로그램들이 주를 이루었습니다.

Client - Server Model Application

- 클라이언트 - 서버 구조의 애플리케이션이 점점 많아지기 시작

Web Application

- Browser 에 웹 페이지를 보여주는 웹 애플리케이션의 태동

Modern Application

- Frontend가 하나의 큰 요소가 되었고, Backend API 는 점점 MSA 와 같은 형태로 여러 백엔드 API 를 Frontend가 호출하거나 Backend API 끼리도 서로 호출하는 구조로 변모해감

<br/>



## 2010 년도 이전, 이후

2010년도 까지는 어느 정도는 정적인 페이지와 Flash 등을 이용한 PC 기반의 웹 애플리케이션이 많았던 것으로 기억합니다. <br/>

하지만 2010년도 이후로 스마트폰이 나타나고 모바일 메신저도 도입되면서 이전보다 트래픽이 더 커지기도 했고, 여러 종류의 모바일 기기를 지원해야 했으며, 백엔드 애플리케이션 하나로 다양한 요구사항을 감당할 수 없는 경우가 생기게 되어서 필요에 따라 백엔드를 여러 개의 백엔드로 나눠서 조합하는 마이크로 서비스 아키텍처가 등장했습니다.<br/>

또한 인프라 환경 역시 클라우드 중심으로 이동하면서 클라우드 네이티브 개발이 중요해지게 되었습니다.<br/>

모바일 환경이 점점 수요가 많아지면서 웹페이지를 렌더링 하기 보다는 API 를 제공하는 백엔드 서비스로서의 역할이 점점 강조되기 시작했으며 프론트엔드는 점점 독자적인 분야로 발전하게 되었습니다.<br/>

또한 인터넷 통신을 이용한 전자상거래 서비스가 많아지면서 백엔드 서비스가 처리해야 할 트래픽의 레벨도 늘어났으며, 이전과는 다르게 실시간 데이터를 제공해야 한느 경우도 있었으며, 인터넷 사업이 커지면서 인터넷 사업의 특성상 장애 발생했을때 손실이 커진 경우에 대한 대책 역시 필요해졌습니다. <br/>

이렇게 사업적인 환경 뿐만 아니라 IT기기들 역시 점점 변모하면서 레거시 개발환경 보다는 새로운 형태의 서비스 개발 방식이 필요해지게 됐습니다.<br/>

<br/>



## 스케일 아웃

VM 단위로 서비스를 분리하는 케이스 역시 이 때부터 생겨났습니다. 웹 페이지 등에 들어가야 할 비즈니스 로직들이 세분화되고 사용자의 데이터 역시 기하급수적으로 증가하다보니 특정 기능 하나가 잡고 있는 병목구간이 전체 서비스의 발목을 잡고있거나 특정 기능 하나를 수정하기 위해서 전체 서비스 배포를 해야 하는 구조에서는 인터넷 비즈니스 사업에서 소모되는 손실이 컸기 때문입니다.<br/>

주로 특정 서비스를 스케일 아웃을 하거나, 특정 비즈니스로직만을 jar 로 배포하거나 독자적인 vm 에 배포하는 등의 형태가 생겼습니다.<br/>

<br/>



## Front Server

최근에는 Gateway 라고도 알려진 개념은 예전에는 Front Server 라고 불리는 시스템으로 개발되어 왔던 적이 있습니다.<br/>

이 당시에는 Front Server 가 Product, User, Inventory, Notification 등과 같은 각각의 서비스의 서버와 통신을 하고 조율하는 역할을 하는 프록시 같은 서버 역할을 수행하기도 했습니다.<br/>

<br/>



## 암달의 법칙

스케일아웃을 하더라도 서비스마다 사용하는 Database 를 별도로 분리하지 않으면 암달의 법칙에 의해 처리량에 한계가 발생하게 됩니다.<br/>

암달의 법칙은 암달의 저주라고도 불리는데, 컴퓨터 시스템 내의 일부를 개선할 때 최대 성능 향상이 얼마나 이뤄지는 지를 계산하는데에 사용되는 법칙입니다.<br/>

(참고 : [암달의 법칙](https://ko.wikipedia.org/wiki/%EC%95%94%EB%8B%AC%EC%9D%98_%EB%B2%95%EC%B9%99))

![](https://wikimedia.org/api/rest_v1/media/math/render/svg/67042d42e795383b5c9cb1ff6a289d33ca4f062b)

![](https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/AmdahlsLaw.svg/450px-AmdahlsLaw.svg.png)

위 그림에서 부하가 1% 에 해당하는 리소스를 잡을 경우의 그래프는 초록색그래프이며 99% 의 리소스로 어느 정도의 성능향상이 이뤄지는 지를 보여주고 있습니다. 이 때 Processor 를 256 개까지 성능에 비약적인 발전이 이뤄지지만 어느 순간부터는 동일한 성능을 내게 됩니다.<br/>

<br/>



## 마이크로서비스는 무엇일까?

마틴 파울러의 개인 홈페이지 ([https://martinfowler.com/articles/microservices.html](https://martinfowler.com/articles/microservices.html) ) 내에는 Microservice 를 설명하는 글이 있는데 한번 꼭 읽어보시길 추천드립니다.

![msa-intro](./img/01-msa-intro/1.png)

> “마이크로서비스 아키텍처"라는 용어는 지난 몇 년 동안 소프트웨어 애플리케이션을 독립적으로 배포 가능한 서비스 모음으로 설계하는 특정 방식을 설명하기 위해 등장했습니다. 이 아키텍처 스타일에 대한 정확한 정의는 없지만 비즈니스 기능, 자동화된 배포, 엔드포인트의 인텔리전스, 언어 및 데이터의 분산 제어를 중심으로 한 조직과 관련된 몇 가지 공통적인 특징이 있습니다.

<br/>



그리고 Micro Service 의 Architecture 에 대해서는 아래와 같이 요약해주고 있습니다.

In short, the microservice architectural style is an approach to developing a single application as a suite of small services, each running in its own process and communicating with lightweight mechanisms, often an HTTP resource API. These services are built around business capabilities and independently deployable by fully automated deployment machinery. There is a bare minimum of centralized management of these services, which may be written in different programming languages and use different data storage technologies.<br/>

<br/>



간단히 말해, 마이크로서비스 아키텍처 스타일은 하나의 애플리케이션을 여러 개의 작은 서비스 모음으로 개발하는 접근 방식으로, **각각 자체 프로세스에서 실행되고 가벼운 메커니즘(주로 HTTP 리소스 API)과 통신**합니다. 이러한 서비스는 비즈니스 기능을 중심으로 구축되며 완전 자동화된 배포 기계에 의해 독립적으로 배포할 수 있습니다. 이러한 서비스는 서로 다른 프로그래밍 언어로 작성되고 서로 다른 데이터 저장 기술을 사용할 수 있으며, 최소한의 중앙 집중식 관리만 이루어집니다.<br/>

<br/>

주요 내용들을 추려보면 이렇습니다.

- 애플리케이션을 독립적인 서비스 단위로 구축
  - "하나의 애플리케이션을 여러 개의 작은 서비스의 집합(suite)으로 개발하며, 각각은 자체적인 프로세스로 실행되며 각각의 HTTP resource API 와 같은 가벼운 메커니즘으로 통신한다"
- 자동화된 배포 
  - 비즈니스 기능을 중심으로 구축되며 완전 자동화된 배포 기계에 의해 독립적으로 배포할 수 있습니다.
- 서로 다른 프로그래밍 언어로 작성 가능
- 서로 다른 데이터 저장 기술을 사용할 수 있으며 최소한의 중앙집중식 관리



<br/>



## 모놀리딕



## 프로젝트 보다는 프로덕트



## 인프라 자동화



## 장애를 대비한 설계 (Design for failure)



## MSA 설계 - 서비스 바운더리 (Service Boundary)

